const presetAnswers = {
  'what is the upsc syllabus for 2025?': {
    answer: `### UPSC Civil Services Examination (CSE) Syllabus 2025

**Subject Tag:** Polity · General Studies  
**Relevant For:** Prelims, Mains, Interview  
**GS Papers:** GS-1 · GS-2 · GS-3 · GS-4

#### Exam Structure
1. Preliminary Examination – qualifying only  
2. Main Examination – 1750 marks (merit ranking)  
3. Personality Test – 275 marks

#### Stage 1 · Preliminary Examination
**Paper I – General Studies (200 marks | 2 hrs | 100 MCQs)**
- Current events (national + international)
- History of India & Indian National Movement
- Indian + World Geography (physical, social, economic)
- Indian Polity & Governance (Constitution, Panchayati Raj, Rights)
- Economy & Social Development (poverty, inclusion, demographics, social sector)
- Environment & Biodiversity (general awareness, climate change)
- General Science

**Paper II – CSAT (200 marks | 2 hrs | 80 MCQs)**
- Comprehension and communication
- Logical reasoning, analytical ability, decision-making
- Basic numeracy, data interpretation, mental ability
- Qualifying paper (minimum 33%). Only Paper I marks count for cutoff.

#### Stage 2 · Main Examination (1750 marks)
**Qualifying Papers (300 marks each)**
- Indian Language (selected from Schedule VIII)
- English (minimum 25% required in both)

**Essay Paper (250 marks)**
- Two essays of ~1000–1200 words each on diverse topics.

**General Studies (4 × 250 marks)**
- **GS I:** Heritage & Culture · History · World & Indian Geography · Society
- **GS II:** Governance · Constitution · Polity · Social Justice · International Relations
- **GS III:** Technology · Economic Development · Environment · Security · Disaster Management
- **GS IV:** Ethics · Integrity · Aptitude · Case studies

**Optional Subject (500 marks)**
- One optional subject; Paper I & II (250 marks each). Choose based on interest/availability.

#### Stage 3 · Personality Test (275 marks)
- Board interview assessing mental alertness, balance of judgement, leadership, moral integrity, awareness of socio-political issues.

#### Quick Reminders
- Total marks for ranking = 1750 (Mains) + 275 (Interview) = **2025**.
- Prelims is only qualifying; CSAT needs 33% to clear.
- Current affairs permeate every paper; maintain dynamic-static linkages.
- Official syllabus: Refer to latest UPSC notification on [upsc.gov.in](https://www.upsc.gov.in).`,
    keywords: ['upsc syllabus', 'syllabus 2025', 'prelims syllabus', 'mains syllabus', 'upsc cse syllabus', 'civil services syllabus']
  },

  'give me notes on indian history': {
    answer: `### Indian History — High-Yield Notes
**Subject Tag:** History | **Relevant For:** Prelims & Mains (GS-1)

#### Ancient India (Prehistoric – 647 CE)
- **Prehistoric cultures:** Stone Age phases (Paleolithic → Mesolithic → Neolithic); Indus Valley (Harappa, Mohenjo-Daro, Dholavira, Lothal) noted for town-planning, drainage, Indo-Mesopotamian trade.
- **Vedic & Mahajanapadas:** Early Vedic pastoral society transitions to agrarian Later Vedic order; 16 Mahajanapadas with Magadha dominance under Bimbisara/Ajatashatru; Buddhism (563 BCE) & Jainism (6th cent. BCE) oppose ritualism.
- **Classical empires:** Mauryan administration (Arthashastra, Ashoka’s Dhamma, Kalinga War 261 BCE); Gupta “Golden Age” (Kalidasa, Aryabhata, Ajanta art) before Huna incursions trigger decline.

#### Medieval India (647 – 1707 CE)
- **Regional kingdoms:** Palas–Pratiharas–Rashtrakutas (Tripartite struggle), Cholas for maritime networks, Rajput polities sustaining temple culture.
- **Delhi Sultanate:** Slave, Khilji, Tughlaq, Sayyid, Lodi dynasties; iqta revenue, Alauddin’s market controls, Indo-Islamic architecture (Qutub Minar), Mongol resistance.
- **Deccan & South:** Vijayanagara (Harihara & Bukka) blending Shaiva-Vaishnava traditions, Hampi monuments, Bahmani rivalry.
- **Mughal era:** Babur’s Panipat/Khanwa victories, Humayun’s exile-return, Akbar’s mansabdari + Sulh-i-Kul, Jahangir/Shah Jahan art zenith (Taj Mahal), Aurangzeb’s Deccan wars leading to provincial assertion.

#### Modern India (1707 – 1947)
- **Colonial consolidation:** Plassey (1757) & Buxar (1764) secure Company rule; Regulating Act 1773, Pitt’s India Act 1784, successive Government of India Acts centralize authority.
- **Socio-religious reform:** Raja Rammohan Roy (Brahmo), Ishwar Chandra Vidyasagar (social legislation), Dayanand Saraswati (Arya Samaj), Sir Syed (Aligarh) modernist agenda.
- **Freedom struggle timeline:** 1857 revolt; INC Moderate (1885–1905) vs Extremist (1905–1919) phases; Gandhian movements (Non-Cooperation, Civil Disobedience, Quit India); revolutionary streams (Ghadar, HSRA, INA); negotiations (Cripps, Cabinet, Mountbatten Plans) → Partition (1947) + Constitution (1950).
- **Key personalities & anchors:** Ashoka, Akbar, Shivaji, Gandhi, Nehru, Patel, Subhas Bose, Bhagat Singh, Ambedkar; milestone years 563 BCE, 322 BCE, 1526, 1857, 1885, 1947, 1950.

#### Exam Lens
- **Prelims:** Chronology, art sites, administrative systems, personalities, economic features.
- **Mains:** Cause–effect analysis, socio-economic impact, regional comparisons, historiography, linking static history with contemporary governance debates.

**Preferred sources:** NCERTs 6–12, R.S. Sharma, Satish Chandra, Bipan Chandra, Spectrum.`,
    keywords: ['indian history', 'history notes', 'ancient history', 'medieval history', 'modern history', 'upsc history']
  },

  'explain the indian constitution': {
    answer: `### Indian Constitution — Snapshot & Structure
**Subject Tag:** Polity | **Relevant For:** UPSC Prelims & Mains (GS-2)

#### Foundational Facts
- Adopted on **26 Nov 1949**, effective **26 Jan 1950**.
- Quasi-federal with unitary tilt; borrows from multiple constitutions.
- Currently **448 Articles**, **12 Schedules**, **105+ Amendments** (2024).

#### Core Pillars
- **Preamble:** Sovereign · Socialist · Secular · Democratic · Republic; ideals of Justice, Liberty, Equality, Fraternity.
- **Fundamental Rights (Part III):** Equality (14–18), Freedom (19–22), Protection from exploitation (23–24), Freedom of religion (25–28), Cultural/educational rights (29–30), Remedies (32).
- **Directive Principles (Part IV):** Welfare goals—social justice, equitable distribution, village panchayats, environment, equal pay; complement FRs.
- **Fundamental Duties (51A):** Added by 42nd Amendment; 11 duties including constitutional respect, unity, environment, education (parents’ duty added via 86th Amendment).

#### Institutional Architecture
- **Executive (52–78):** President, Vice President, PM-led Council of Ministers (collectively responsible to Lok Sabha).
- **Legislature (79–122):** Bicameral Parliament; some states also bicameral.
- **Judiciary (124–147; 214–231):** Independent Supreme Court, High Courts, subordinate courts with judicial review powers.

#### Articles & Amendments to Cite
- Article 1 (Union of States), 14/19/21 (Equality, Freedom, Life), 32 (Remedies “heart & soul”), 356 (President’s Rule), 360 (Financial emergency), 370/371 (special provisions).
- 42nd Amendment (1976) “Mini Constitution”, 73rd/74th (local self-government), 86th (Right to Education), 101st (GST), 103rd (EWS quota).

#### Federal vs Unitary Traits
- **Federal:** Dual polity, written constitution, division of powers, independent judiciary, rigid amendments.
- **Unitary:** Single citizenship, integrated judiciary/services, emergency powers, Parliament’s supremacy during crises.

#### Constitutional/Statutory Bodies
- Election Commission, UPSC, Finance Commission, CAG, Attorney General, NITI Aayog, Lokpal/Lokayuktas, National Commissions.

#### Exam Tips
- Track recent SC verdicts, constitutional amendments, Finance Commission recommendations.
- Relate FR–DPSP balance, cooperative federalism, fiscal federalism (GST Council).
- Quote article numbers/case law for value addition.

**References:** Indian Polity (M. Laxmikanth), Bare Act, NCERT Polity books, latest UPSC notifications.`,
    keywords: ['indian constitution', 'constitution', 'fundamental rights', 'directive principles', 'articles', 'polity', 'upsc polity']
  },

  'what are the best books for upsc preparation?': {
    answer: `### Best Books & Resources for UPSC CSE (2025)
**Subject Tag:** Study Strategy | **Relevant For:** Prelims + Mains

#### Foundation Layer (NCERTs)
- History (Class 6–12), Geography (Class 6–12 + atlas), Social & Political Life + Indian Constitution at Work, Economics (Class 9–12 macro/micro), Science (Class 6–10 + Class 11–12 Biology ecology units).

#### Standard Texts
- **History & Culture:** R.S. Sharma, Satish Chandra, Bipan Chandra + Spectrum, Nitin Singhania.
- **Geography:** G.C. Leong, Majid Hussain (India & World), Oxford/Orient BlackSwan Atlas.
- **Polity:** Indian Polity (M. Laxmikanth) for multiple revisions; D.D. Basu for depth.
- **Economy:** Ramesh Singh, Sanjiv Verma, Economic Survey + Budget highlights.
- **Environment:** Shankar IAS book, NCERT Biology ecology chapters, current conventions/acts.
- **Science & Tech:** NCERT base, Science Reporter/The Hindu science section focusing on applications.
- **Ethics (GS-IV):** Lexicon for Ethics, Integrity & Aptitude; Subba Rao & P.N. Roy Chowdhury for cases.
- **Essay:** Essays for Civil Services (Pulkit Khare) or equivalent; curate ideas via editorials/op-eds.

#### Current Affairs Stack
- Daily: The Hindu or Indian Express + PIB briefs.
- Monthly: Yojana, Kurukshetra, Vision/Insights compilations (pick one set).
- Annual: India Year Book (selective), Economic Survey summary.
- Reference: PRS Legislative Research for bills/acts.

#### Optional Subject Resources
- Choose based on interest, background, material availability, scoring potential.
- Popular options: PSIR, Sociology, Anthropology, Geography, History, Literature subjects.
- Use standard university texts + toppers’ notes + PYQs; treat optional equal to GS (500 marks).

#### Practice Material
- UPSC PYQs (last 10 years Prelims, 5 years Mains).
- Prelims test series (sectional + full-length) from a trusted institute.
- Mains answer writing initiatives (Vision, ForumIAS, etc.) for timed responses.

#### Quick Strategy Tips
- Limit booklist; prioritize depth, revisions, and note-making.
- Follow revision loop (Day-7, Day-30, pre-exam crash).
- Maintain integrated current-affairs notes tagged under GS/Optional themes.
- Begin answer writing by Month 4; attempt essays fortnightly.
- Track new schemes, amendments, judgments via monthly digests.

Consistent study, smart revisions, and reflective practice trump an ever-growing library.`,
    keywords: ['best books', 'upsc books', 'preparation books', 'study material', 'upsc study material', 'recommended books', 'book list', 'books for upsc', 'suggest books', 'list of books', 'booklist']
  },

  'give me a detailed study plan for upsc': {
    answer: `### 12-Month UPSC Study Plan (2025)
**Subject Tag:** Study Strategy | **Audience:** First-time or repeat aspirants needing structure

#### Phase 1 · Foundation (Months 1–3)
- Weeks 1–4: NCERTs for History, Geography, Polity, Economics, Science (6–8 hrs/day with active notes).
- Weeks 5–8: First pass of standard books (History, Geography, Polity). Complete Laxmikanth once.
- Weeks 9–12: Economy (Ramesh Singh), Environment (Shankar IAS), S&T basics, start consistent newspaper + monthly magazine habit.

#### Phase 2 · Deep Dive & Skills (Months 4–6)
- Month 4: Finish remaining texts, begin answer writing (2–3/day), join Prelims sectional tests.
- Month 5: First full revision, solve last 10 years of Prelims PYQs topic-wise, weekly mock + analysis.
- Month 6: Integrate current affairs with static subjects, formally start optional prep, improve answer structure/value-adds.

#### Phase 3 · Prelims War Room (Months 7–9)
- Month 7: Daily CA (12–18 months), one mock + review each day, CSAT twice a week.
- Month 8: Rapid revision cycles, plug weak spots, memorize high-yield lists (treaties, constitutional bodies, maps).
- Month 9: Daily full-length mocks, micro-notes, CSAT speed drills, simulate exam timing (Prelims ~May/Jun).

#### Phase 4 · Mains Marathon (Months 10–12)
- Month 10: Weekly essay, GS paper-wise schedule, optional intensification, 5–6 answers/day.
- Month 11: Increase to 8–10 answers/day, join Mains test series, blend optional/GS with contemporary examples.
- Month 12: Crash revision across GS + optional, essays twice a week, focus on presentation (headings, diagrams). Mains ~Sep/Oct.

#### Phase 5 · Interview Prep (Post-Mains)
- Deconstruct DAF, prep hobby/academic talking points, attend 10+ mock interviews, refresh last-year current affairs, polish communication. Interviews typically Feb–Apr.

#### Sample Daily Template
- Morning (6–10 AM): Fresh topic + current affairs + quick revision.
- Late Morning (10–1): Answer writing or PYQs.
- Afternoon (2–5): Optional subject/test review.
- Evening (5–8): Standard book revision + mock analysis.
- Night (8–10): Current affairs consolidation, note maintenance, light reading.

#### Non-Negotiables
1. Revision loop: revisit topics at Day 7, Day 30, pre-exam.
2. Answer writing from Month 4; emphasize structure, keywords, data, diagrams.
3. Current affairs notes sorted under GS/Optional headings.
4. Test series: Prelims (Month 4 onward) and Mains (Month 10 onward) with mistake logs.
5. Optional subject parity with GS (500 marks).
6. Health: 7 hrs sleep, exercise/meditation, weekly downtime to avoid burnout.

#### Quick Tips
- Maintain mock-error tracker, convert into targeted revision sets.
- Build flashcards/one-pagers for schemes, judgments, stats.
- Use digital tools (Notion/OneNote) for searchable notes.
- Working professionals can stretch timelines but keep sequence intact.

Consistency, smart revision, and reflective practice matter more than raw study hours—adjust pace, not milestones.`,
    keywords: ['study plan', 'upsc study plan', 'detailed study plan', 'preparation plan', 'upsc strategy', 'how to prepare for upsc', 'study strategy', 'preparation strategy', 'upsc roadmap', 'plan for upsc']
  },

  'translate this to hindi modern history': {
    answer: `### आधुनिक भारत का इतिहास — संक्षिप्त हिंदी नोट्स
**Subject Tag:** History | **GS Paper:** GS-1 | **Relevant For:** UPSC Prelims & Mains

#### औपनिवेशिक काल की प्रमुख घटनाएँ
- **1757 · प्लासी का युद्ध:** रॉबर्ट क्लाइव की जीत से ब्रिटिश नियंत्रण की शुरुआत।
- **1764 · बक्सर का युद्ध:** बंगाल, बिहार, उड़ीसा पर कंपनी की पकड़।
- **1857 · प्रथम स्वतंत्रता संग्राम:** मंगल पांडे, रानी लक्ष्मीबाई, बहादुर शाह जफर; परिणाम—कंपनी राज समाप्त, सत्ता सीधे क्राउन के अधीन।
- **1885 · भारतीय राष्ट्रीय कांग्रेस:** ए.ओ. ह्यूम की पहल, उदारवादी नेतृत्व (दादा भाई नौरोजी, गोपाल कृष्ण गोखले)।
- **1905 · बंगाल विभाजन:** लॉर्ड कर्जन की नीति से स्वदेशी व बहिष्कार आंदोलन।
- **1919 · जलियांवाला बाग + रॉलेट एक्ट:** दमनकारी कानूनों के विरुद्ध देशव्यापी रोष।

#### स्वतंत्रता आंदोलन के चरण
- **प्रारंभिक प्रयास:** गदर पार्टी (1913), होम रूल लीग (1916, तिलक व एनी बेसेंट)।
- **गांधी युग:** असहयोग (1920–22), सविनय अवज्ञा/दांडी मार्च (1930–34), भारत छोड़ो (1942) “करो या मरो”, भूमिगत प्रतिरोध।

#### स्वतंत्रता एवं संवैधानिक मील के पत्थर
- **15 अगस्त 1947:** स्वतंत्रता व विभाजन; डोमिनियन स्टेटस।
- **26 जनवरी 1950:** संविधान लागू, भारत गणराज्य।
- रियासतों का एकीकरण (सरदार पटेल, वी.पी. मेनन), संविधान सभा की बहसें।

#### प्रमुख व्यक्तित्व
- महात्मा गांधी (सत्याग्रह), जवाहरलाल नेहरू (आधुनिक भारत), सुभाष चंद्र बोस (आजाद हिंद फ़ौज), भगत सिंह-राजगुरु-सुखदेव (क्रांतिकारी), रानी लक्ष्मीबाई व तात्या टोपे (1857), बाल गंगाधर तिलक (लोकमान्य), सरदार पटेल (रियासत एकीकरण)।

#### परीक्षा के लिए फोकस
- वर्षवार घटनाक्रम, प्रमुख अधिनियम (Regulating/Pitt’s/Government of India Acts), कांग्रेस सत्र, आंदोलनकारी मांगें, किसान-मज़दूर संगठनों का योगदान, प्रेस व शिक्षा नीतियाँ।
- उत्तर लिखते समय तिथियाँ, संधियाँ और व्यक्तित्वों के सटीक योगदान अवश्य शामिल करें।

**नोट:** किसी विशिष्ट अनुच्छेद/अंश का अनुवाद चाहिए तो वही पाठ साझा करें ताकि सटीक रूपांतरण दिया जा सके।`,
    keywords: ['translate hindi', 'hindi translation', 'modern history hindi', 'आधुनिक इतिहास']
  }
};

function tightenPresetAnswer(answer) {
  if (!answer || typeof answer !== 'string') return '';
  return answer
    .replace(/\r\n/g, '\n')
    .replace(/\n{2,}/g, '\n')
    .trim();
}

function normalizePrompt(prompt) {
  return prompt
    .toLowerCase()
    .trim()
    .replace(/[^\w\s]/g, '')
    .replace(/\s+/g, ' ');
}

function findPresetAnswer(message) {
  if (!message || typeof message !== 'string' || message.trim().length < 10) {
    return null;
  }

  const normalized = normalizePrompt(message);

  // Only match if the message is very similar to the preset key
  // This prevents false matches like "tell me about mughal empire" matching "give me notes on indian history"
  for (const [key, preset] of Object.entries(presetAnswers)) {
    const normalizedKey = normalizePrompt(key);

    // Exact or very close match (at least 80% similarity)
    if (normalized === normalizedKey ||
      (normalized.length >= normalizedKey.length * 0.8 && normalized.includes(normalizedKey)) ||
      (normalizedKey.length >= normalized.length * 0.8 && normalizedKey.includes(normalized))) {
      return tightenPresetAnswer(preset.answer);
    }

    // Check keywords only if they appear as complete words/phrases, not just substrings
    for (const keyword of preset.keywords) {
      const normalizedKeyword = normalizePrompt(keyword);
      // Only match if keyword is a significant part of the message (at least 50% of keyword length)
      if (normalizedKeyword.length >= 5 && normalized.includes(normalizedKeyword)) {
        // Additional check: make sure it's not just a substring match in a longer word
        const keywordRegex = new RegExp(`\\b${normalizedKeyword.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')}\\b`, 'i');
        if (keywordRegex.test(message.toLowerCase())) {
          return tightenPresetAnswer(preset.answer);
        }
      }
    }
  }

  return null;
}

export { presetAnswers, findPresetAnswer, normalizePrompt };
